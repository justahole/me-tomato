# 登录的安全问题

> 没有绝对的安全。现在的绝对安全就是黑客破解成本高，高到破解成本高于破解后得到的收益。

## 算法知识

基本上用到用于密码的算法都是不可逆的哈希算法。下面是哈希算法的特点，以及几个常用的哈希算法。

## 数据库的设计

现在的应用都假设黑客可能拿到我们的用户登录数据库。而现在要做的是当用户拿到我们的数据库，也不能知道拿什么样的明文密码的登录。（有很多用户都喜欢在多个平台使用同一个登录密码）

`简单的哈希算法加密`

md5(password) 如果黑客拿到这样的数据库，那跟明文没有区别。为什么这么说，因为很早就有md5加密后的证书的原文是什么样的一个对照表（彩虹表）。只要稍加翻译便能破解出其中大部分的原文密码。

`加盐`

所谓的加盐就是把用户明文密码中加如一些特殊的文本，然后在使用哈希算法加密。这样的好处是像彩虹表这样的工具将不那么好用。（然而没有绝对的安全）

假如我们的源代码被破解。（最简单的就是买通内部开发人员，或者自己就是）

那么黑客可以自己利用彩虹表的原理构建出一个表格。再破解得到原文密码。所以这种方式也并不安全。

`随机的盐`

每一个用户配备一个独一无二的盐，那么就算被盗取了数据库与算法，黑客要通过生成彩虹表的成本将相当高，因为一个盐巴就需要一个彩虹表。

没有绝对的安全，能做的就是是破解成本更高。

`高CPU哈希算法`

可以使用一种大量消耗 cpu 的 hash 算法对抗暴力破解，比如 PBKDF2 或者 bcrypt 。

`salt 的值不要和最终 hash 的结果存在同一个数据库`

与数据库注入有关，才疏学浅，不懂。

## 本项目的使用方式

本项目假设使用的是 HTTPS。（懒得去搞一个轮子）
客户端登录的时候发送账户获取盐，用户使用盐与哈希算法算出登录的 hash 值。（使用慢哈希，将算法分摊给客户端，减少服务端的压力）。得到相应的hash值在进行比对即可。

## 参考文档

[设计安全的账号系统的正确姿势](https://blog.coderzh.com/2016/01/03/security-design/)
[即使被拖库，也可以保证密码不泄露](https://blog.coderzh.com/2016/01/10/a-password-security-design-example/)
